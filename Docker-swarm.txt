Docker-Swarm
cluster of docker conatiners are managed by docker swarm.
manage application to stay up and running.
In Docker-swarm multiple docker hosts run in swarm mode, some work as master and some work as worker.
A single machine can work as master as well as worker. Master will remain the state and instruct to maintain number of replicas. 
Minimum of 3 manager nodes (has election within them to make a leader) the data remain in sync between them by raft consensus algorithm.
Number of masters are in odd numbers = (n-1)/2  n is number of nodes required.
Worker node always requires a master node, where as master can work independently. Every workers has an agent installed which tells current state to master.
Master and worker works with secure communication ie TLS (Transport Layer Security) and Certificate Authority. Worker has a token to communicate with master.

all nodes should ne in one cluster (Network)
>>docker should be enable on each node (master and worker)
>>docker --version
>>service docker start
>>service docker status
>>docker info | head -50 (swarm will be inactive)
>>docker swarm init (to initialize docker swarm)
this above command will also provide token command for workers to join.
>>docker node ls (to check nodes in cluster as worker/master)
>>docker swarm join-token manager (to add managers to a cluster)
>>docker swarm join-token worker (to generate new token to add workers)
>>docker swarm leave (to come out of cluster)
>>docker info | less (to check status of swarm)
>>docker node rm -f <nodename> (to remove worker/manager from cluster)
>>docker node inspect <node name> | less (details of node)
>>docker node promote <node name> (to promote node to master *managers are in odd numbers*)
>>docker node demote <node name>

>>docker run container run -it alpine 192.168.25.10 (eg to run a container and get ping on one node cluster but below is for swarm)
>>docker service (on master run commands only)
>>watch docker container ls (to see running container state after 2 sec)
>>docker service create -d alpine ping <master ip>
>>docker service ls
>>docker service inspect <service id> | less
>>docker service logs <service id>
>>docker service create -d --replicas 4 alpine (4 number of containers will be created in this service, container will be distributed among master and workers)
>>docker service ps <service id> (will tell you details tasks in service)
>>docker container rm -f <container id/ first 2 digits of id>
* DOcker manager maintains desire state of service/containers.
>>docker service scale <service id>=<number> (to scale up/dowm to desire number)
>>docker service create -d -p 8090:80 nginx
*(service can be accessed from all nodes master/worker IP:port)

Docker swarm visualizer : to have better visualization of services and nodes work

>>docker service create mode=global alpine ping 8.8.8.8 (mode global make sure that the service is present on all nodes eg antivirus, monitoring service)
